
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Lexorva - Drafting & AI Chat</title>
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&family=Rajdhani:wght@400;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="lexorva.css" />
</head>
<body class="lexorva-body">

  <header class="top-nav">
    <div class="logo-text">LEXORVA</div>
    <nav class="nav-links">
      <a href="index.html" class="home-link">Home</a>
      <a href="pricing.html" class="home-link">Pricing</a>
      <a href="login.html" class="home-link">Sign Up / Login</a>
    </nav>
  </header>

  <main class="main-container">

    <!-- Left Column -->
    <section class="left-column">
      <div class="mode-buttons">
        <button id="ask-mode" class="mode-button active" onclick="setMode('ask')">
          üí¨ Ask Lexorva
        </button>
        <button id="draft-mode" class="mode-button" onclick="setMode('draft')">
          ‚úèÔ∏è Drafting
        </button>
      </div>

      <textarea id="main-input" placeholder="Enter your request..." class="main-textarea"></textarea>

      <div class="button-group">
        <button class="submit-button" onclick="handleSubmit()">Submit</button>
        <input type="file" id="file-upload" accept=".pdf,.docx,.txt" class="upload-input">
      </div>

      <div id="response-container" style="display:none;">
        <h3>AI Response:</h3>
        <textarea id="ai-response" class="response-textarea"></textarea>
        <button class="download-button" onclick="downloadPDF()">Download as PDF</button>
      </div>
    </section>

    <!-- Right Column (Guided Drafting) -->
    <section id="guided-drafting" class="right-column">
      <h2>Guided Drafting</h2>
      <p class="guided-subtitle">Optional prompts to improve your draft</p>

      <label>Document Type:</label>
      <input type="text" id="doc-type">

      <label>State:</label>
      <select id="state">
        <option value="">Select State</option>
        <option value="California">California</option>
        <option value="New York">New York</option>
      </select>

      <label>County:</label>
      <select id="county">
        <option value="">Select County</option>
        <option value="Los Angeles">Los Angeles</option>
        <option value="New York County">New York County</option>
      </select>

      <label>Court Name:</label>
      <input type="text" id="court-name">

      <label>Parties Involved:</label>
      <input type="text" id="parties">

      <label>Key Facts:</label>
      <input type="text" id="key-facts">

      <label>Legal Issues:</label>
      <input type="text" id="legal-issues">

      <label>Conclusion / Relief Sought:</label>
      <input type="text" id="relief-sought">

      <label>Attorney Signature Block:</label>
      <input type="text" id="attorney-signature">
    </section>

  </main>

  <footer class="footer">
    ¬© 2025 LEXORVA. All Rights Reserved.
  </footer>

  <script>
    let currentMode = 'ask';

    function setMode(mode) {
      currentMode = mode;
      document.getElementById('ask-mode').classList.remove('active');
      document.getElementById('draft-mode').classList.remove('active');
      document.getElementById(mode + '-mode').classList.add('active');

      document.getElementById('guided-drafting').style.display = (mode === 'draft') ? 'block' : 'none';
    }

    async function handleSubmit() {
      const mainInput = document.getElementById('main-input').value.trim();
      if (!mainInput) {
        alert('Please enter your request.');
        return;
      }

      let url = (currentMode === 'ask') ? '/analyze' : '/analyze-upload';
      let payload = { text: mainInput };

      if (currentMode === 'draft') {
        payload = {
          text: mainInput,
          document_type: document.getElementById('doc-type').value,
          state: document.getElementById('state').value,
          county: document.getElementById('county').value,
          court_name: document.getElementById('court-name').value,
          parties_involved: document.getElementById('parties').value,
          key_facts: document.getElementById('key-facts').value,
          legal_issues: document.getElementById('legal-issues').value,
          conclusion_relief: document.getElementById('relief-sought').value,
          attorney_signature: document.getElementById('attorney-signature').value
        };
      }

      try {
        const response = await fetch(url, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify(payload)
        });

        const result = await response.json();
        document.getElementById('ai-response').value = result.text || 'No response received.';
        document.getElementById('response-container').style.display = 'block';
      } catch (error) {
        console.error(error);
        alert('Error communicating with AI backend.');
      }
    }

    function downloadPDF() {
      const text = document.getElementById('ai-response').value;
      const blob = new Blob([text], { type: 'application/pdf' });
      const link = document.createElement('a');
      link.href = window.URL.createObjectURL(blob);
      link.download = 'Lexorva_Document.pdf';
      link.click();
    }
  </script>

</body>
</html>
